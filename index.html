<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virtual Piano Sheet Converter</title>
    <script>
        function convertSheetToKeypress(input) {
            const bpm = 120; // You can adjust the bpm (beats per minute) here
            const output = [];
            let previousChar = '';

            // Iterate over the input and process the characters
            for (let i = 0; i < input.length; i++) {
                const char = input[i];
                const nextChar = input[i + 1];

                // Check for note or bracketed note sequence
                if (char === '[') {
                    let noteSequence = '';
                    i++; // Skip '['
                    while (input[i] !== ']' && i < input.length) {
                        noteSequence += input[i];
                        i++;
                    }
                    i++; // Skip ']'

                    if (nextChar === ' ') {
                        output.push(`keypress("${noteSequence[0]}", 0.15, bpm)`);  // First keypress in bracket
                        output.push(`keypress("${noteSequence[1]}", 0.15, bpm)`);  // Second keypress in bracket
                        output.push(`rest(0.5, bpm)`);  // 0.5 rest after bracketed notes with space
                    }
                } 
                else if (char === ' ' && previousChar !== ']') {
                    output.push(`rest(0.5, bpm)`);  // Space between notes
                } 
                else if (char === '-') {
                    output.push(`rest(1, bpm)`); // Dash, representing 1 beat rest
                } 
                else {
                    output.push(`keypress("${char}", 0.15, bpm)`); // Regular note press
                    if (nextChar !== ' ' && nextChar !== ']') {
                        output.push(`rest(0.25, bpm)`);  // 0.25 rest between notes when not brackets or spaces
                    }
                }
                previousChar = char;
            }

            return output.join('\n');
        }

        function handleConversion() {
            const input = document.getElementById('sheetInput').value;
            const output = convertSheetToKeypress(input);
            document.getElementById('output').innerText = output;
        }
    </script>
</head>
<body>
    <h1>Virtual Piano Sheet Music Converter</h1>
    <textarea id="sheetInput" rows="4" cols="50"></textarea><br><br>
    <button onclick="handleConversion()">Convert</button>
    <pre id="output"></pre>
</body>
</html>
